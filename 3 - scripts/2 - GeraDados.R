# GERACAO DOS DADOS PARA INVESTIGACAO

# Gera aba -> NBS (PASSO 1)
  
  # SELECT
  # '_' || DADOSOPERACOES.CODIGONBS CODIGO_NBS,
  # NBSV1_1_07CODIGOSCLASSIFICACAO.CODIGODESCRICAO NBS,
  # SUM(DADOSOPERACOES.VALOROPERACAOUSD) VALOR
  # FROM DADOSOPERACOES
  # JOIN NBSV1_1_07CODIGOSCLASSIFICACAO
  # ON DADOSOPERACOES.CODIGONBS = NBSV1_1_07CODIGOSCLASSIFICACAO.CODIGO
  # WHERE DADOSOPERACOES.DATAINICIOSERVICO < TO_DATE('2017-01-01', 'YYYY-MM-DD') AND DADOSOPERACOES.DATACONCLUSAOSERVICO > TO_DATE('2015-12-31', 'YYYY-MM-DD')
  # --WHERE DADOSOPERACOES.ID_OPERACAO NOT IN ('10974308','10974384','10974341','10974354', '10609327')
  # GROUP BY DADOSOPERACOES.CODIGONBS, NBSV1_1_07CODIGOSCLASSIFICACAO.CODIGODESCRICAO
  # ORDER BY VALOR DESC;

# Gera aba -> EMPRESA (PASSO 2)

  # SELECT
  # DADOSOPERACOES.CODIGONBS || '-' ||  DADOSRVS.IDENTIFICACAOVENDEDOR CHAVE,
  # '_' || DADOSOPERACOES.CODIGONBS CODIGO_NBS,
  # NBSV1_1_07CODIGOSCLASSIFICACAO.CODIGODESCRICAO NBS,
  # '_' || DADOSRVS.IDENTIFICACAOVENDEDOR ID_VENDEDOR,
  # DADOSVENDEDORES.IDENTIFICACAONOME VENDEDOR,
  # SUM(DADOSOPERACOES.VALOROPERACAOUSD) VALOR,
  # AVG(DADOSOPERACOES.VALORDIARIOUSD) VALOR_DIARIO_MEDIO
  # FROM DADOSVENDEDORES
  # JOIN DADOSRVS
  # ON DADOSVENDEDORES.IDENTIFICACAO = DADOSRVS.IDENTIFICACAOVENDEDOR
  # JOIN DADOSOPERACOES
  # ON DADOSRVS.ID_RVS = DADOSOPERACOES.ID_RVS
  # JOIN NBSV1_1_07CODIGOSCLASSIFICACAO
  # ON DADOSOPERACOES.CODIGONBS = NBSV1_1_07CODIGOSCLASSIFICACAO.CODIGO
  # WHERE DADOSOPERACOES.DATAINICIOSERVICO < TO_DATE('2017-01-01', 'YYYY-MM-DD') AND DADOSOPERACOES.DATACONCLUSAOSERVICO > TO_DATE('2015-12-31', 'YYYY-MM-DD')
  # --   AND DADOSOPERACOES.CODIGONBS IN ('122042000', '109043600', '109043400', '114099000', '112012900', '106071000', '120014000', '114011800', '114011900', '105021490', '109052000', '106011000', '102010000', '113012000', '115022000', '115011000', '114033000', '120015990', '106052000', '109059900', '118054000', '115090000', '114011400', '113022100', '114011100', '106019000', '119021000', '105023100', '109059100', '109051100', '115013000', '109043900', '114032990', '114011200', '105021410', '101120000', '111033912', '114031000', '114032410')
  # --  AND DADOSOPERACOES.ID_OPERACAO NOT IN ('10974308','10974384','10974341','10974354', '10609327')
  # AND DADOSOPERACOES.VALORDIARIOUSD > 0
  # GROUP BY
  # DADOSOPERACOES.CODIGONBS,
  # NBSV1_1_07CODIGOSCLASSIFICACAO.CODIGODESCRICAO,
  # DADOSRVS.IDENTIFICACAOVENDEDOR,
  # DADOSVENDEDORES.IDENTIFICACAONOME
  # ORDER BY VALOR DESC;
